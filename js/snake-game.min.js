SnakeGame=function(){var g,a;var s=37,v=38,t=39,n=40,h=66,m=65;var x=[],w=[v,v,n,n,s,t,s,t,h,m];var o={cellSize:10,cellPadding:1,initialLen:5,moveInterval:20,nodeColor:"rgba(0, 0, 0, 0.3)"};var A,d;var k;function l(C){document.onreadystatechange=function(){if(document.readyState=="complete"){document.addEventListener("keydown",c,false);r(C);j()}}}function r(C){if(C!==undefined){for(key in C){o[key]=C[key]}}}function j(){k=document.createElement("snake-game-canvas");if(k!=null){k=document.createElement("canvas");k.id="snake-game-canvas";k.width=window.innerWidth;k.height=window.innerHeight;k.style.position="absolute";k.style.zIndex=0;k.style.margin=0;document.body.insertBefore(k,document.body.childNodes[0])}A=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(C){window.setTimeout(C,1000/60)};a=new e(k,o.cellSize,o.cellPadding);g=new p(a,o.initialLen,o.moveInterval)}function B(){if(g.started){g.move();d=A(B)}else{a.clearGrid()}}function q(){g.start();d=A(B)}function b(){g.stop();a.clearGrid();x=[];window.cancelAnimationFrame(d)}function f(){if(g!==undefined&&a!==undefined){b()}document.body.removeChild(k);document.removeEventListener("keydown",c,false)}function c(C){keyCode=C.keyCode;if(keyCode==27){b()}else{if(g.started){g.changeDirection(keyCode,true)}else{x.push(keyCode);y()}}}function y(){if(!g.started&&u(w,x)){q()}else{if(w.length==x.length){b()}}}function u(D,C){if(D===C){return true}if(D===undefined||C===undefined||D.length!=C.length){return false}for(i=0;i<D.length;i++){if(D[i]!==C[i]){return false}}return true}function z(D,C){return Math.floor(Math.random()*(C-D+1)+D)}function p(E,L,H){var E=E,F=[],N,C=L,M=0,D=E.getDimension(),J=0,I=0,O=true,K=H,G;this.started=false;this.create=function(){startPx=Math.floor(D[0]/2);startPy=Math.floor(D[1]/2);randDirection=z(s,n);F=[];this.changeDirection(randDirection,false);F.push([startPx,startPy]);for(i=0;i<C;i++){startPx-=J;startPy-=I;F.push([startPx,startPy])}this.createNewNode()};this.move=function(){currentTime=Date.now();if(!this.started||(currentTime-G)<K){return}G=currentTime;newHead=[F[0][0]+J,F[0][1]+I];F.unshift(newHead);lastNode=F.pop();if(O){O=false;E.clearGrid();for(i=0;i<F.length;i++){node=F[i];E.drawNode(node)}E.drawNode(N)}else{E.clearNode(lastNode);E.drawNode(newHead)}this.checkColision();this.checkNewNode()};this.checkColision=function(){head=F[0];if(head[0]>D[0]||head[0]<0||head[1]>D[1]||head[1]<0){b()}for(i=1;i<F.length;i++){if(head[0]==F[i][0]&&head[1]==F[i][1]){b()}}};this.createNewNode=function(){newNodeX=z(0,D[0]-1);newNodeY=z(0,D[1]-1);N=[newNodeX,newNodeY]};this.checkNewNode=function(){head=F[0];if(head[0]==N[0]&&head[1]==N[1]){F.unshift(N);this.createNewNode();E.drawNode(N)}};this.changeDirection=function(P,Q){switch(P){case s:if(Q){if(M!=t){M=s;J=-1;I=0}}else{M=s;J=-1;I=0}break;case v:if(Q){if(M!=n){M=v;J=0;I=-1}}else{M=v;J=0;I=-1}break;case t:if(Q){if(M!=s){M=t;J=1;I=0}}else{M=t;J=1;I=0}break;case n:if(Q){if(M!=v){M=n;J=0;I=1}}else{M=n;J=0;I=1}break}};this.start=function(){G=Date.now();this.create();this.started=true;O=true};this.stop=function(){this.started=false}}function e(E,J,I){var E=E;var I=I;var J=J;var H=Math.floor(E.width/J);var G=Math.floor(E.height/J);var F=E.getContext("2d");var C=(Math.PI/180)*0;var D=(Math.PI/180)*360;F.fillStyle=o.nodeColor;E.style.marginRight=E.style.marginLeft=(E.width-H*J)/2;E.style.marginTop=E.style.marginBottom=(E.height-G*J)/2;this.drawNode=function(K){px=Math.floor((K[0]*J)+(J/2));py=Math.floor((K[1]*J)+(J/2));F.beginPath();F.arc(px,py,J/2-I,C,D,true);F.fill()};this.clearNode=function(K){px=Math.floor(K[0]*J);py=Math.floor(K[1]*J);F.clearRect(px,py,J,J)};this.clearGrid=function(){F.clearRect(0,0,E.width,E.height)};this.getDimension=function(){return[H,G]}}return{init:l,destroy:f}};